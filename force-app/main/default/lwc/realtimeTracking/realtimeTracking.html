<template>
    <lightning-card title="Real-time Shipment Tracking" icon-name="custom:custom18">
        <div slot="actions">
            <lightning-button 
                label="Refresh" 
                onclick={handleRefresh}
                variant="brand"
                class="refresh-button">
            </lightning-button>
        </div>
        
        <div class="slds-p-around_medium">
            <template if:true={isLoading}>
                <div class="slds-align_absolute-center slds-p-around_large">
                    <lightning-spinner alternative-text="Loading shipments..." size="medium"></lightning-spinner>
                </div>
            </template>
            
            <template if:false={isLoading}>
                <div class="tracking-container">
                    <template for:each={shipments} for:item="shipment">
                        <div key={shipment.id} class="shipment-card slds-card slds-m-bottom_small">
                            <div class="slds-card__header slds-grid">
                                <div class="slds-media slds-media_center slds-has-flexi-truncate">
                                    <div class="slds-media__figure">
                                        <lightning-icon 
                                            icon-name="custom:custom18" 
                                            size="medium"
                                            alternative-text="Shipment">
                                        </lightning-icon>
                                    </div>
                                    <div class="slds-media__body">
                                        <h2 class="slds-card__header-title">
                                            <span class="slds-text-heading_small">{shipment.name}</span>
                                        </h2>
                                        <p class="slds-text-body_small slds-text-color_weak">
                                            Last updated: {shipment.lastUpdate}
                                        </p>
                                    </div>
                                </div>
                                <div class="slds-no-flex">
                                    <span class={statusClass} data-status={shipment.status}>
                                        {shipment.status}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="slds-card__body slds-card__body_inner">
                                <div class="slds-grid slds-gutters_small slds-m-bottom_small">
                                    <div class="slds-col slds-size_1-of-2">
                                        <div class="location-info">
                                            <lightning-icon 
                                                icon-name="utility:location" 
                                                size="x-small"
                                                class="location-icon">
                                            </lightning-icon>
                                            <div>
                                                <p class="slds-text-body_small slds-text-color_weak">Current Location</p>
                                                <p class="slds-text-body_regular">{shipment.currentLocation}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <div class="location-info">
                                            <lightning-icon 
                                                icon-name="utility:target" 
                                                size="x-small"
                                                class="location-icon">
                                            </lightning-icon>
                                            <div>
                                                <p class="slds-text-body_small slds-text-color_weak">Destination</p>
                                                <p class="slds-text-body_regular">{shipment.destination}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="progress-section">
                                    <div class="slds-grid slds-grid_vertical-align-center">
                                        <div class="slds-col slds-size_10-of-12">
                                            <lightning-progress-bar 
                                                value={shipment.progress} 
                                                variant="circular"
                                                class="progress-bar">
                                            </lightning-progress-bar>
                                        </div>
                                        <div class="slds-col slds-size_2-of-12 slds-text-align_right">
                                            <span class="progress-text">{shipment.progress}%</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="eta-section slds-m-top_small">
                                    <lightning-icon 
                                        icon-name="utility:clock" 
                                        size="xx-small">
                                    </lightning-icon>
                                    <span class="slds-text-body_small">ETA: {shipment.eta}</span>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </template>
        </div>
    </lightning-card>
</template>